---
title: Security Profiles
description: Profile format, built-in policies, and creating custom profiles
---

Profiles are pre-configured capability sets that define what a sandboxed process can access. They codify security policy so you don't have to specify flags manually every time.

## Why Profiles?

Manually specifying capabilities for every tool is tedious and error-prone:

```bash
# Without profiles - verbose and easy to misconfigure
nono run --allow . --read ~/.claude --read-file ~/.claude/config.json -- claude
```

Profiles simplify this:

```bash
# With profiles - concise and auditable
nono run --profile claude-code -- claude
```

## Profile Sources

Profiles can come from three sources, in order of precedence:

| Source | Location | Trust Level |
|--------|----------|-------------|
| CLI flags | Command line | Highest - explicit user intent |
| User profiles | `~/.config/nono/profiles/` | Medium - user-defined |
| Built-in profiles | Compiled into binary | Base - audited defaults |

CLI flags always override profile settings.

## Profile Format

Profiles use TOML format:

```toml
[meta]
name = "my-agent"
version = "1.0.0"
description = "Profile for my custom agent"

# Set to true for apps with interactive TUI (preserves TTY)
interactive = false

[workdir]
# Controls automatic CWD sharing: "none", "read", "write", or "readwrite"
access = "readwrite"

[filesystem]
# Directory permissions (recursive)
allow = ["$HOME/.config/my-agent"]
read = []
write = []

# Single file permissions (non-recursive)
allow_file = []
read_file = ["$HOME/.gitconfig"]
write_file = []

[network]
block = false  # Network allowed by default; set to true to block

# See "Secrets Section" below for configuring secrets
# See "Hooks Section" below for auto-installing agent hooks
```

### Working Directory Section

The `[workdir]` section controls whether and how the current working directory is automatically shared with the sandboxed process. This is set per-profile so each application can declare its own CWD requirements.

| Value | Meaning |
|-------|---------|
| `none` | No automatic CWD access (default if section omitted) |
| `read` | Read-only access to CWD |
| `write` | Write-only access to CWD |
| `readwrite` | Full read+write access to CWD |

When a profile specifies a `[workdir]` access level, nono will prompt the user to confirm CWD sharing (unless `--allow-cwd` is used to skip the prompt).

### Secrets Section

The `[secrets]` section maps keystore account names to environment variable names. Secrets are loaded from the system keystore (macOS Keychain / Linux Secret Service) before the sandbox is applied, then injected as environment variables.

```toml
[secrets]
openai_api_key = "OPENAI_API_KEY"
database_url = "DATABASE_URL"
```

To use secrets from a profile, add the `--secrets` flag:

```bash
nono run --profile my-agent --secrets -- my-command
```

See [Secrets Management](/cli/usage/secrets) for details on storing secrets in the keystore.

### Hooks Section

The `[hooks.<target>]` section defines hooks that nono will automatically install for specific applications. This enables sandbox-aware error handling without manual setup.

```toml
[hooks.claude-code]
event = "PostToolUseFailure"      # When to trigger
matcher = "Read|Write|Edit|Bash"  # Which tools to match
script = "nono-hook.sh"           # Script from nono's embedded hooks
```

Currently supported targets:
- `claude-code` - Installs to `~/.claude/hooks/` and updates `~/.claude/settings.json`

Hook installation is idempotent - nono only installs or updates when needed.

### Interactive Mode

The `interactive` field (default: `false`) is a **top-level** field (not nested under any section) that indicates whether the application has an interactive terminal UI that requires TTY preservation:

```toml
[meta]
name = "my-agent"

# Top-level field, not under [workdir] or any other section
interactive = true

[workdir]
access = "readwrite"
```

When `true`, nono uses direct exec mode (equivalent to `--exec` flag), which preserves the terminal for apps like Claude Code, vim, or htop.

## Environment Variables

Profiles support these environment variables in path values:

| Variable | Expands To |
|----------|------------|
| `$WORKDIR` | Current working directory (from `--workdir` or cwd) |
| `$HOME` | User's home directory |
| `$XDG_CONFIG_HOME` | XDG config directory (default: `~/.config`) |
| `$XDG_DATA_HOME` | XDG data directory (default: `~/.local/share`) |
| `$TMPDIR` | System temporary directory |
| `$UID` | Current user ID |

## Creating User Profiles

1. Create the profiles directory:
   ```bash
   mkdir -p ~/.config/nono/profiles
   ```

2. Create a TOML file:
   ```bash
   cat > ~/.config/nono/profiles/my-agent.toml << 'EOF'
   [meta]
   name = "my-agent"
   version = "1.0.0"

   [filesystem]
   allow = ["$WORKDIR"]

   [network]
   block = true  # Block all network access
   EOF
   ```

3. Use the profile:
   ```bash
   nono run --profile my-agent -- my-agent-command
   ```

## Built-in Profile Policies

These profiles are compiled into nono and can be used without any configuration. Each section documents the exact permissions granted.

### claude-code

```toml
[meta]
name = "claude-code"
version = "1.0.0"
description = "Anthropic Claude Code CLI agent"

[workdir]
access = "readwrite"

# Preserve TTY for interactive terminal UI
interactive = true

[filesystem]
allow = ["$HOME/.claude"]
allow_file = ["$HOME/.claude.json"]

[network]
block = false

[hooks.claude-code]
# Auto-installed hook for sandbox-aware error handling
event = "PostToolUseFailure"
matcher = "Read|Write|Edit|Bash"
script = "nono-hook.sh"
```

**Grants:** Read+write to working directory (via `[workdir]`) and `~/.claude`, read+write to `~/.claude.json`, full network access.

**Special features:**
- `interactive = true` preserves TTY for Claude's terminal UI
- Hooks auto-install to `~/.claude/hooks/` for sandbox-aware error handling

See [Claude Code client guide](/cli/clients/claude-code) for full details.

---

### opencode

```toml
[meta]
name = "opencode"
version = "1.0.0"
description = "OpenCode AI coding assistant"

[workdir]
access = "readwrite"

[filesystem]
allow = [
  "$HOME/.config/opencode",
  "$HOME/.cache/opencode",
  "$HOME/.local/share/opencode"
]

[network]
block = false
```

**Grants:** Read+write to working directory (via `[workdir]`) and OpenCode config/cache/data directories, full network access.

---

### openclaw

```toml
[meta]
name = "openclaw"
version = "1.0.0"
description = "OpenClaw messaging gateway"

[workdir]
access = "read"

[filesystem]
allow = [
  "$HOME/.openclaw",
  "$HOME/.config/openclaw",
  "$HOME/.local",
  "$TMPDIR/openclaw-$UID"
]

[network]
block = false
```

**Grants:** Read-only access to working directory (via `[workdir]`), read+write to OpenClaw config, state, local data, and temp directories, full network access.

---

## Overriding Built-in Profiles

CLI flags always take precedence over profile settings:

```bash
# Use claude-code profile but block network
nono run --profile claude-code --net-block -- claude

# Add extra directory access
nono run --profile claude-code --allow ~/other-project -- claude
```

You can also create a user profile with the same name to override a built-in profile entirely.

## Requesting New Built-in Profiles

If you'd like a built-in profile for a tool not listed here:

1. Open an issue on the [nono GitHub repository](https://github.com/always-further/nono/issues)
2. Include:
   - Tool name and repository URL
   - Required filesystem access patterns
   - Network requirements
   - Any special considerations

Built-in profiles are reviewed for security before inclusion.
